<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="未登录首页"/>
    <meta name="author" content="cc"/>
    <title>中国医学影像共享服务平台</title>

    <!-- CSS -->
    <!-- Bootstrap core CSS -->
    <link th:href="@{css/bootstrap.min.css}" rel="stylesheet" />


    <!-- Custom styles for this template -->
    <link th:href="@{css/navbar-fixed-top.css}" rel="stylesheet" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->


    <!-- Favicon and touch icons -->
    <script>
        function upload() {
            window.location.href = '/uploadcase';
        }
        function tobedone() {
            window.location.href = '/tobedone';

        }

    </script>
    <style type="text/css">
        body {
            height: 100%;
            background-color: #26292d;
        }
        dt{
            color: #ffbf5b;
            font-size:16px;
            font-weight: bold;
            margin-bottom: 10px;
            }
        dd{
            color: bisque;
        }
        #midcontainer{
            background: #404040;
        }
        .panel-heading{
            color: #ffffff!important;
            background-color: #404040!important;
            border-color: #404040!important;
        }
        .panel-body{
            /*border-top-color: #4b4e52;*/
            color:#66ccff;
            border-top: 1px solid #8e8e8e!important;
            background-color:#404040!important;
        }
        li a{
            color: #ffbf55;
            text-decoration: none;
        }
        li a:hover{
            color:#ffffff
        }
        li a:focus{
            color: #ffbf55;
            text-decoration: none;
        }
        .panel-default{
            border-color:#525252;
            background-color: #525252;
        }
        .panel-title:hover{
            color:inherit
        }
        .panel-title:focus{
            color:inherit
        }
        .breadcrumb{
            background-color: inherit;
        }
          .line {
              height:1px;
              width:100%;
              background:#777777;
              overflow:hidden;
              margin-top: 20px;
              margin-bottom: 20px;
          }

    </style>
</head>

<body>

<!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/home">中国医学影像共享服务平台</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <form class="navbar-form navbar-left">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="征象"/>
                </div>
                <button type="button" class="btn btn-default">搜索</button>

            </form>
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a th:if="${type==1}" href="#"  class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">病例管理<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="/myupload">我的上传</a></li>
                        <li><a href="/mysave">我的保存</a></li>
                        <li><a href="/mychecked">我的审核</a></li>
                        <li id="ul2"><a href="/mymodify">我的退修</a></li>

                    </ul>
                </li>

                        <li><a href="/logout">退出</a></li>

                <button th:if="${type==1}" class="btn btn-danger navbar-btn" type="button" onclick="upload()">  上传 </button>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<div class="container">

    <!-- Main component for a primary marketing message or call to action -->

    <div class="row clearfix">
        <div class="col-md-6 column">
            <ul class="breadcrumb">
                <li>
                    <a  th:href="@{/second(id=${id})}">
                        头颈五官</a>
                </li>

                <li>
                    <a  th:href="@{/third(id=${id},secondlevel=${secondlevel})}">
                        眼及眼眶病变
                    </a>
                </li>
                <li th:text="${disease}" class="active">
                    病变
                </li>

            </ul>
        </div>
        <div class="col-md-5 column" >

            <a href=""><span class="label label-primary">收藏病例</span> </a>
        </div>

        <div class="col-md-1 column" >

           <a href="#" onclick="javascript:history.go(-1);"><span class="label label-success">后退</span> </a>
        </div>

    </div>
    <div class="row clearfix">
        <div class="col-md-2 column">
            <div class="panel-group" id="panel-20144">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <a class="panel-title" data-toggle="collapse" data-parent="#panel-20144" href="#panel-element-162746">临床信息</a>
                    </div>
                    <div id="panel-element-162746" class="panel-collapse in">
                        <div class="panel-body">
                            <ul>
                                <li><a href="#lab" name="lab">实验室检查</a></li>
                                <li><a href="#spec" name="spec">专科检查</a></li>
                                <li><a href="#past" name="past">既往史/生育史/家族史</a></li>
                            </ul>
                        </div>
                    </div>

                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <a class="panel-title collapsed" data-toggle="collapse" data-parent="#panel-20144" href="#panel-element-886149">基本信息</a>
                    </div>
                    <div id="panel-element-886149" class="panel-collapse collapse">
                        <div class="panel-body">
                            <ul>
                                <li><a href="#age" name="age">年龄</a></li>
                                <li><a href="#sex" name="sex">性别</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <a class="panel-title collapsed" data-toggle="collapse" data-parent="#panel-20144" href="#panel-element-886150">诊断依据</a>
                    </div>
                    <div id="panel-element-886150" class="panel-collapse collapse">
                        <div class="panel-body">
                        <ul>
                            <li><a href="#dignose" name="dignose">诊断依据</a></li>
                        </ul>
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <a class="panel-title collapsed" data-toggle="collapse" data-parent="#panel-20144" href="#panel-element-886151">鉴别诊断</a>
                    </div>
                    <div id="panel-element-886151" class="panel-collapse collapse">
                        <div class="panel-body">
                        <ul>
                            <li><a href="#differ" name="differ">鉴别诊断</a></li>
                        </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6 column" id="midcontainer" style="padding: 20px" >


            <dt >
                [实验室检查]
            </dt>
            <dd th:text="${thecasea.lab_exam}">
                实验室检查实验室检查实验室检查实验室检查实验室检查实验室检查实验室检查实验室检查。实验室检查实验室检查实验室检查实验室检查实验室检查实验室检查实验室检查实验室检查实验室检查实验室检查。实验室检查实验室检查实验室检查实验室检查
            </dd>
            <div class="line" name="spec"></div>

            <dt>
                [专科检查]
            </dt>
            <dd th:text="${thecasea.extra_exam}">
                专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查专科检查。
            </dd>

            <div class="line" name="past"></div>

            <dt>
                [既往史/生育史/家族史]
            </dt>
            <dd th:text="${thecasea.present_history}">
                既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史既往史/生育史/家族史。
            </dd>
            <div class="line" name="sex"></div>

            <dt>[性别]</dt>
            <dd th:text="${thecasea.sex}">
                男，40岁
            </dd>
            <div class="line" name="age"></div>

            <dt>[年龄]</dt>
            <dd th:text="${thecasea.age}">
                男，40岁
            </dd>
            <div class="line" name="dignose"></div>


            <dt>
                [诊断依据]
            </dt>
            <dd th:text="${thecasea.present_history}">
                诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据诊断依据。
            </dd>
            <div class="line" name="differ"></div>


            <dt>
                [鉴别诊断]
            </dt>
            <dd th:text="${thecasea.present_history}">
                鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断鉴别诊断。
            </dd>


        </div>
        <div class="col-md-4 column">

            <div id="dicomImageWrapper" style="width:360px;height:360px;position:relative;color: white;"
                 class="cornerstone-enabled-image"
                 oncontextmenu="return false"
                 unselectable='on'
                 onselectstart='return false;'
                 onmousedown='return false;'>
                <div id="dicomImage" oncontextmenu="return false"
                     style="width:360px;height:360px;top:0px;left:0px; position:absolute">
                </div>
                <div id="topleft" style="position: absolute;top:0px; left:0px">
                    Patient Name
                </div>
                <div id="topright" style="position: absolute;top:0px; right:0px">
                    Render Time:
                </div>
                <div id="bottomright" style="position: absolute;bottom:0px; right:0px">
                    Zoom:
                </div>
                <div id="bottomleft" style="position: absolute;bottom:0px; left:0px">
                    WW/WC:
                </div>

            </div>
            <div><span id="coords"></span></div>

            <div class="carousel slide" id="carousel-466973">
                <ol class="carousel-indicators">
                    <li class="active" data-slide-to="0" data-target="#carousel-466973">
                    </li>
                    <li data-slide-to="1" data-target="#carousel-466973">
                    </li>
                    <li data-slide-to="2" data-target="#carousel-466973">
                    </li>
                </ol>
                <div class="carousel-inner">


                    <div class="item active">

                        <img alt="" th:src="${img0.path}" />
                        <div class="carousel-caption">
                        </div>
                    </div>
                    <div class="item">
                        <img alt="" th:src="${img1.path}" />
                        <div class="carousel-caption">

                        </div>
                    </div>
                    <div class="item">
                        <img alt="" th:src="${img2.path}" />
                        <div class="carousel-caption">

                        </div>
                    </div>

                </div> <a class="left carousel-control" href="#carousel-466973" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a> <a class="right carousel-control" href="#carousel-466973" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
            </div>
            <dl>
                <dt>
                    影像学表现
                </dt>
                <dd th:text="${thecasea.CT_symptom}">
                    影像学表现影像学表现影像学表现影像学表现影像学表现影像学表现影像学表现
                </dd>

            </dl>
        </div>
    </div>

    <!-- /container -->
</div>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script th:src="@{/js/jquery.js}" type="text/javascript"></script>
<script th:src="@{/js/bootstrap.min.js}" type="text/javascript"></script>
<script th:src="@{/js/bootstrap-table.js}" type="text/javascript"></script>
</body>
<script src="/js/cornerstone.js" type="text/javascript"></script>

<!-- include special code for these examples which provides images -->
<script src="/js/exampleImageIdLoader.js" type="text/javascript" ></script>

<script type="text/javascript">
    $(document).ready(function() {

        var imageIds = [
            'example://1',
            'example://2'];
        var currentImageIndex = 0;


        // updates the image display
        function updateTheImage(imageIndex) {
            return cornerstone.loadAndCacheImage(imageIds[imageIndex]).then(function(image) {
                currentImageIndex = imageIndex;
                var viewport = cornerstone.getViewport(element);
                cornerstone.displayImage(element, image, viewport);
            });
        }

        // image enable the element
        var element = $('#dicomImage').get(0);
        cornerstone.enable(element);

        // set event handlers
        function onImageRendered(e, eventData) {
            $('#topright').text("Render Time:" + eventData.renderTimeInMs + " ms");
        }
        $(element).on("CornerstoneImageRendered", onImageRendered);

        // setup handlers before we display the image
        function onImageRendered(e, eventData) {
            // set the canvas context to the image coordinate system
            cornerstone.setToPixelCoordinateSystem(eventData.enabledElement, eventData.canvasContext);

            // NOTE: The coordinate system of the canvas is in image pixel space.  Drawing
            // to location 0,0 will be the top left of the image and rows,columns is the bottom
            // right.
            var context = eventData.canvasContext;
            context.beginPath();
            context.strokeStyle = 'white';
            context.lineWidth = .5;
            context.rect(128, 90, 50, 60);
            context.stroke();
            context.fillStyle = "white";
            context.font = "6px Arial";
            context.fillText("Tumor Here", 128, 85);

            $('#topright').text("Render Time:" + eventData.renderTimeInMs + " ms");
            $('#bottomleft').text("WW/WL:" + Math.round(eventData.viewport.voi.windowWidth) + "/" + Math.round(eventData.viewport.voi.windowCenter));
            $('#bottomright').text("Zoom:" + eventData.viewport.scale.toFixed(2));

        }
        $(element).on("CornerstoneImageRendered", onImageRendered);

        // load and display the image
        var imagePromise = updateTheImage(0);

        // add handlers for mouse events once the image is loaded.
        imagePromise.then(function() {
            viewport = cornerstone.getViewport(element);
            $('#bottomright').text("Zoom: " + viewport.scale.toFixed(2) + "x");
            $('#bottomleft').text("WW/WC:" + Math.round(viewport.voi.windowWidth) + "/" + Math.round(viewport.voi.windowCenter));

            // add event handlers to pan image on mouse move
            $('#dicomImage').mousedown(function (e) {
                var lastX = e.pageX;
                var lastY = e.pageY;

                var mouseButton = e.which;

                $(document).mousemove(function (e) {
                    var deltaX = e.pageX - lastX,
                        deltaY = e.pageY - lastY;
                    lastX = e.pageX;
                    lastY = e.pageY;

                    if (mouseButton == 1) {
                        var viewport = cornerstone.getViewport(element);
                        viewport.voi.windowWidth += (deltaX / viewport.scale);
                        viewport.voi.windowCenter += (deltaY / viewport.scale);
                        cornerstone.setViewport(element, viewport);
                        $('#bottomleft').text("WW/WL:" + Math.round(viewport.voi.windowWidth) + "/" + Math.round(viewport.voi.windowCenter));
                    }
                    else if (mouseButton == 2) {
                        var viewport = cornerstone.getViewport(element);
                        viewport.translation.x += (deltaX / viewport.scale);
                        viewport.translation.y += (deltaY / viewport.scale);
                        cornerstone.setViewport(element, viewport);
                    }
                    else if (mouseButton == 3) {
                        var viewport = cornerstone.getViewport(element);
                        viewport.scale += (deltaY / 100);
                        cornerstone.setViewport(element, viewport);
                        $('#bottomright').text("Zoom: " + viewport.scale.toFixed(2) + "x");
                    }
                });

                $(document).mouseup(function (e) {
                    $(document).unbind('mousemove');
                    $(document).unbind('mouseup');
                });
            });

            $('#dicomImage').on('mousewheel DOMMouseScroll', function (e) {

                // Firefox e.originalEvent.detail  0 scroll back, 0 scroll forward
                // chrome/safari e.originalEvent.wheelDelta 0 scroll back, 0 scroll forward
                if (currentImageIndex == 0) {
                    updateTheImage(1);
                }
//                }
                else {
                    if (currentImageIndex == 1) {
                        updateTheImage(0);
                    }
                }
                //prevent page fom scrolling
                return false;
            });

            // Add event handler to the ww/wc apply button
            $('#x256').click(function (e) {
                $('#dicomImage').width(256).height(256);
                $('#dicomImageWrapper').width(256).height(256);
                cornerstone.resize(element);
            });

            $('#x512').click(function (e) {
                $('#dicomImage').width(512).height(512);
                $('#dicomImageWrapper').width(512).height(512);
                cornerstone.resize(element);
            });

            $('#invert').click(function (e) {
                var viewport = cornerstone.getViewport(element);
                if (viewport.invert === true) {
                    viewport.invert = false;
                } else {
                    viewport.invert = true;
                }
                cornerstone.setViewport(element, viewport);
            });

            $('#interpolation').click(function (e) {
                var viewport = cornerstone.getViewport(element);
                if (viewport.pixelReplication === true) {
                    viewport.pixelReplication = false;
                } else {
                    viewport.pixelReplication = true;
                }
                cornerstone.setViewport(element, viewport);
            });
            $('#hflip').click(function (e) {
                var viewport = cornerstone.getViewport(element);
                viewport.hflip = !viewport.hflip;
                cornerstone.setViewport(element, viewport);
            });
            $('#vflip').click(function (e) {
                var viewport = cornerstone.getViewport(element);
                viewport.vflip = !viewport.vflip;
                cornerstone.setViewport(element, viewport);
            });
            $('#rotate').click(function (e) {
                var viewport = cornerstone.getViewport(element);
                viewport.rotation+=90;
                cornerstone.setViewport(element, viewport);
            });
            $(element).mousemove(function(event)
            {
                var pixelCoords = cornerstone.pageToPixel(element, event.pageX, event.pageY);
                var x = event.pageX;
                var y = event.pageY;
                $('#coords').text("pageX=" + event.pageX + ", pageY=" + event.pageY + ", pixelX=" + pixelCoords.x + ", pixelY=" + pixelCoords.y);
            });
        });



    });

</script>
</html>